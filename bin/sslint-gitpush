#!/bin/bash
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"
WORKING_DIR=$(pwd)

help_and_exit() {
    echo "---------------------------------";
    echo "  Available settings:";
    echo "---------------------------------";
    echo "  -m, --message                  commit message";
    echo ""
    echo "---------------------------------";
    echo "  Example usage:"
    echo "---------------------------------";
    echo "  e.g. sslint-gitpush   -m 'PATCH'   app/src ";
    echo "---------------------------------";
    echo ""
    echo ""

    exit;
}

message="WIP"
dir='app/src'
while (( $# )); do
  case $1 in
    -m|--message)     message=$2;shift ;;
    -*)               printf 'Unknown option: %q\n\n' "$1";
                      help_and_exit 1 ;;
    *) dir=$1;;
  esac
  shift
done

echo ""
echo ""
echo "---------------------------------";
echo "  Running GIT PUSH";
echo "---------------------------------";
echo "  directory of script:           $SCRIPT_DIR";
echo "  directory to commit:           $WORKING_DIR/$dir";
echo "---------------------------------";
echo "  message:                       $message";
echo "---------------------------------";
echo ""
echo ""

echo "# going to right directory: $WORKING_DIR/$dir"
cd $WORKING_DIR/$dir

echo "# check git status"
git status

echo "# adding files to git repo"
git add . -A
#git add $WORKING_DIR/$also
#git add $WORKING_DIR/$logFile

echo "# committing files to git repo"
git commit . -m "$message"
#git commit $WORKING_DIR/$also -m "$message"
#git commit $WORKING_DIR/$logFile -m "$message"

echo "# pushing commits to git repo"
git pull

echo "# pushing commits to git repo"
git push

echo "# going back to: $WORKING_DIR"
cd $WORKING_DIR

echo "# check git status"
git status

echo "################################################"
echo "################################################"
echo "################################################"
