#!/bin/bash
if [ -z "$(git status --porcelain)" ]; then
    : ${dir:=app/src} # dir will take on the value "app/src" if not overridden
    : ${configFile:=app/_config.php} # configFile will take on the value "app/_config.php" if not overridden
    echo "# Working directory clean"
    > KNOWN_ISSUES
    dir=$dir vendor/bin/php-lint >> KNOWN_ISSUES
    configFile=$configFile vendor/bin/php-bugfix >> KNOWN_ISSUES
    git add KNOWN_ISSUES
    git commit app/src -m "PATCH: automated cleanup"
    git push
    echo "
---------------------------
DONE
---------------------------
    "
else
    echo "
---------------------------
Sorry, can not run, there are uncommitted changes
---------------------------
    "
fi
